# 요구사항 정의서 (Requirement Definition)

## 1. 프로젝트 개요
본 문서는 **Salon Manager** (미용실 예약 관리 서비스)의 관리자용 웹 페이지 및 백엔드 서버에 대한 요구사항을 정의한다. 이 시스템은 1인 개발자에 의해 구축되며, 미용실의 예약, 고객, 매출, 설정을 효율적으로 관리하는 것을 목표로 한다.

## 2. 시스템 환경 및 구성
- **Front-end**: React (Vite), TypeScript, Ant Design
- **Back-end**: NestJS, TypeScript, MariaDB (MySQL 8.0 호환)
- **Infrastructure**: Docker, Nginx
- **Authentication**: 
  - **Admin (Web)**: JWT + Email/Password (Current Implementation)
  - **Customer (App)**: Firebase Auth (Planned for Future Mobile App)

## 3. 상세 기능 요구사항

### 3.1. 인증 및 권한 관리 (Authentication & Authorization)
사용자의 신원을 확인하고, 역할(Role) 및 매장(Shop)에 따른 조회를 제어한다.

| 요구사항 ID | 기능명 | 상세 내용 |
| :--- | :--- | :--- |
| **REQ-AUTH-001** | **관리자 로그인** | • 관리자(Owner/Designer)는 이메일/비밀번호를 통해 로그인한다 (JWT 기반).<br>• Access Token(15분)과 Refresh Token(7일)을 이용해 세션을 관리한다. |
| **REQ-AUTH-002** | **고객 인증 (Future)** | • 추후 개발될 모바일 앱 고객은 Firebase Auth를 통해 인증한다.<br>• DB의 `firebase_uid` 컬럼을 통해 기존 고객 데이터와 계정을 연동한다. |
| **REQ-AUTH-003** | **접근 제어** | • 로그인하지 않은 사용자는 로그인 페이지로 리다이렉트되어야 한다.<br>• 사용자는 본인이 소속된 매장(`shop_id`)의 데이터에만 접근할 수 있어야 한다 (ShopGuard). |
| **REQ-AUTH-004** | **자동 라우팅** | • 로그인 완료 시, 사용자의 매장 정보를 확인하여 `/shops/:shopId/schedule`로 자동 이동한다. |

### 3.2. 일정 관리 (Schedule)
예약 캘린더를 통해 예약 현황을 파악하고 신규 예약을 관리한다.

| 요구사항 ID | 기능명 | 상세 내용 | 참조 기능 ID |
| :--- | :--- | :--- | :--- |
| **REQ-SCH-001** | **메인 캘린더 조회** | • 월/주/일 단위로 예약 일정을 시각적으로 확인할 수 있어야 한다.<br>• 날짜 이동 및 오늘 날짜로 복귀하는 기능을 제공한다. | F-SCH-001, 002 |
| **REQ-SCH-002** | **예약 생성** | • 특정 시간 슬롯을 클릭하거나 '새 예약' 버튼을 통해 신규 예약을 등록한다.<br>• 고객 검색, 시술 메뉴 선택, 담당 디자이너 지정을 포함한다.<br>• 시술 메뉴에 따른 예상 소요시간과 가격이 자동 계산되어야 한다. | F-SCH-003 ~ 011 |
| **REQ-SCH-003** | **예약 상세 및 수정** | • 기존 예약을 클릭하여 상세 정보를 조회하고 내용을 수정할 수 있어야 한다.<br>• 상태 변경(예약 확정, 시술 중, 완료, 취소, 노쇼)을 지원한다. | F-SCH-012 ~ 017 |
| **REQ-SCH-004** | **시술 완료 처리** | • 시술 완료 시 결제 프로세스(결제 수단, 금액 확인)를 거쳐 매출로 기록되어야 한다. | F-SCH-018 |
| **REQ-SCH-005** | **중복 예약 방지** | • 동일 디자이너의 동일 시간대 중복 예약을 방지하는 로직이 적용되어야 한다. | (Seq Diagram) |

### 3.3. 고객 관리 (Client)
매장을 방문하는 고객의 정보를 등록하고 이력을 관리한다.

| 요구사항 ID | 기능명 | 상세 내용 | 참조 기능 ID |
| :--- | :--- | :--- | :--- |
| **REQ-CLI-001** | **고객 목록 조회** | • 등록된 고객 리스트를 페이징 처리하여 조회한다.<br>• 이름, 연락처 등으로 검색이 가능해야 한다.<br>• 다양한 필터(최근 방문일, 노쇼 횟수 등)를 제공한다. | F-CLI-001, 004~010 |
| **REQ-CLI-002** | **신규 고객 등록** | • 팝업을 통해 신규 고객의 이름, 연락처, 성별, 생년월일, 메모 등을 등록한다. | F-CLI-003, 012~014 |
| **REQ-CLI-003** | **고객 상세 정보** | • 고객의 기본 정보 및 과거 시술 내역(Visit Logs), 노쇼 이력, 메모 사항을 한눈에 확인한다.<br>• 고객별 특이사항(태그, 주의 메모)을 관리한다. | F-CLI-011, 015 |
| **REQ-CLI-004** | **엑셀 다운로드** | • 고객 목록 전체를 엑셀(CSV) 파일로 다운로드할 수 있어야 한다. | F-CLI-002 |

### 3.4. 매출 관리 (Sales)
매장의 매출 현황을 집계하고 분석한다.

| 요구사항 ID | 기능명 | 상세 내용 | 참조 기능 ID |
| :--- | :--- | :--- | :--- |
| **REQ-SALE-001** | **일간 매출 현황** | • 선택한 날짜의 총 매출액, 결제 수단별(앱/현장) 매출, 객단가, 시술 건수를 조회한다.<br>• 상세 매출 리스트를 제공한다. | F-SALE-001 ~ 005 |
| **REQ-SALE-002** | **주간/월간 매출 통계** | • 기간별 매출 추이를 그래프(차트)로 시각화하여 제공한다.<br>• 요일별 매출 분석 기능을 제공한다. | F-SALE-006 ~ 009 |
| **REQ-SALE-003** | **매출 데이터 내보내기** | • 조회된 매출 데이터를 엑셀 파일로 다운로드할 수 있어야 한다. | F-SALE-003, 010 |

### 3.5. 설정 및 기초 데이터 (Settings)
서비스 운영에 필요한 기초 정보를 관리한다.

| 요구사항 ID | 기능명 | 상세 내용 | 참조 기능 ID |
| :--- | :--- | :--- | :--- |
| **REQ-SET-001** | **시술 메뉴 관리** | • 매장에서 제공하는 시술 메뉴의 이름, 기본 가격, 소요 시간을 등록/수정/삭제한다. | WEB-010 |
| **REQ-SET-002** | **디자이너 관리** | • 근무하는 디자이너 정보를 등록하고 근무 시간 및 휴무일을 설정한다. | (ERD: Designers) |
| **REQ-SET-003** | **매장 정보 관리** | • 매장 이름, 주소, 전화번호, 영업 시간 등 기본 정보를 관리한다. | (ERD: Shops) |

## 4. 데이터베이스 요구사항
- **데이터 무결성**: 예약 데이터는 고객(Users), 디자이너(Designers), 시술 메뉴(Menus)와 강력한 참조 무결성을 가져야 한다.
- **트랜잭션**: 중복 예약을 방지하고 결제 처리 시 데이터 일관성을 보장하기 위해 트랜잭션 처리가 필수적이다.
- **백업**: 랜섬웨어 등 데이터 유실 상황에 대비한 복구 계획(초기화 스크립트 등)이 수립되어 있어야 한다.

## 5. 비기능 요구사항
- **UI/UX**: Ant Design 프레임워크를 활용하여 일관성 있고 직관적인 UI를 제공해야 한다.
- **반응형**: 데스크탑 환경을 주 타겟으로 하되, 태블릿 등에서도 깨짐 없이 조회 가능해야 한다.
- **보안**: 모든 API 요청은 인증된 사용자(Token)만 호출 가능해야 하며, 본인의 매장 데이터 외에는 접근이 차단되어야 한다.
